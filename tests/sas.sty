
\RequirePackage[T1]{fontenc}
\RequirePackage{times}
\RequirePackage{fancyvrb}
\RequirePackage{array}
\RequirePackage{graphicx}

\newbox\sas@fig
\newlength\sas@figwidth

\newif\ifsas@color
\sas@colorfalse

\DeclareOption{color}{\sas@colortrue}
\ProcessOptions

\def\sasSAfterCaption{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSbatch{%
   \footnotesize%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSBeforeCaption{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSBody{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSBodyDate{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSByContentFolder{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
}
\def\sasSByline{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSBylineContainer{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSCaption{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSCell{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSContainer{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSContentFolder{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
}
\def\sasSContentItem{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
}
\def\sasSContentProcLabel{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSContentProcName{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSContents{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSContentsDate{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSContentTitle{%
   \footnotesize%
   \bfseries%
   \itshape%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSContinued{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSData{%
   \footnotesize%
   \sffamily%
}
\def\sasSDataEmphasis{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
}
\def\sasSDataEmphasisFixed{%
   \footnotesize%
   \itshape%
   \ttfamily%
   \color[rgb]{0,0,0}%
}
\def\sasSDataEmpty{%
   \footnotesize%
   \sffamily%
}
\def\sasSDataFixed{%
   \footnotesize%
   \ttfamily%
}
\def\sasSDataStrong{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSDataStrongFixed{%
   \footnotesize%
   \bfseries%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSDate{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSDocument{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSErrorBanner{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSErrorContent{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSErrorContentFixed{%
   \footnotesize%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSExtendedPage{%
   \footnotesize%
   \itshape%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSFatalBanner{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSFatalContent{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSFatalContentFixed{%
   \footnotesize%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSFolderAction{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
}
\def\sasSFooter{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSFooterEmphasis{%
   \footnotesize%
   \itshape%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSFooterEmphasisFixed{%
   \footnotesize%
   \itshape%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSFooterEmpty{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSFooterFixed{%
   \footnotesize%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSFooterStrong{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSFooterStrongFixed{%
   \footnotesize%
   \bfseries%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSFrame{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSGraph{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSHeader{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSHeaderEmphasis{%
   \footnotesize%
   \itshape%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{0.84,0.85,0.82}%
}
\def\sasSHeaderEmphasisFixed{%
   \footnotesize%
   \itshape%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{0.84,0.85,0.82}%
}
\def\sasSHeaderEmpty{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSHeaderFixed{%
   \footnotesize%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSHeadersAndFooters{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSHeaderStrong{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{0.84,0.85,0.82}%
}
\def\sasSHeaderStrongFixed{%
   \footnotesize%
   \bfseries%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{0.84,0.85,0.82}%
}
\def\sasSIndex{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSIndexAction{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
}
\def\sasSIndexItem{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
}
\def\sasSIndexProcName{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSIndexTitle{%
   \footnotesize%
   \bfseries%
   \itshape%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSLayoutContainer{%
}
\def\sasSLayoutRegion{%
}
\def\sasSList{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSListBA{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSListC{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSListD{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSListE{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSListF{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSListG{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSListH{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSListI{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSListJ{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSListItem{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSListItemBA{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSListItemC{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSListItemD{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSListItemE{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSListItemF{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSListItemG{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSListItemH{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSListItemI{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSListItemJ{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSNote{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSNoteBanner{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSNoteContent{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSNoteContentFixed{%
   \footnotesize%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSOutput{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSPageNo{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSPages{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSPagesDate{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSPagesItem{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
}
\def\sasSPagesProcLabel{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSPagesProcName{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSPagesTitle{%
   \footnotesize%
   \bfseries%
   \itshape%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSParagraph{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSParskip{%
   \footnotesize%
   \bfseries%
   \sffamily%
}
\def\sasSPrePage{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSProcTitle{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSProcTitleFixed{%
   \footnotesize%
   \bfseries%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSRowFooter{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSRowFooterEmphasis{%
   \footnotesize%
   \itshape%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSRowFooterEmphasisFixed{%
   \footnotesize%
   \itshape%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSRowFooterEmpty{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSRowFooterFixed{%
   \footnotesize%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSRowFooterStrong{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSRowFooterStrongFixed{%
   \footnotesize%
   \bfseries%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSRowHeader{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSRowHeaderEmphasis{%
   \footnotesize%
   \itshape%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSRowHeaderEmphasisFixed{%
   \footnotesize%
   \itshape%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSRowHeaderEmpty{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSRowHeaderFixed{%
   \footnotesize%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSRowHeaderStrong{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSRowHeaderStrongFixed{%
   \footnotesize%
   \bfseries%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSSystemFooter{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSSystemFooterBA{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSSystemFooterC{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSSystemFooterD{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSSystemFooterE{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSSystemFooterF{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSSystemFooterG{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSSystemFooterH{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSSystemFooterI{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSSystemFooterJ{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSSystemTitle{%
   \small%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSSystemTitleBA{%
   \small%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSSystemTitleC{%
   \small%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSSystemTitleD{%
   \small%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSSystemTitleE{%
   \small%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSSystemTitleF{%
   \small%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSSystemTitleG{%
   \small%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSSystemTitleH{%
   \small%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSSystemTitleI{%
   \small%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSSystemTitleJ{%
   \small%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSSysTitleAndFooterContainer{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSTable{%
}
\def\sasSTitleAndNoteContainer{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSTitlesAndFooters{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSUserText{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSWarnBanner{%
   \footnotesize%
   \bfseries%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSWarnContent{%
   \footnotesize%
   \sffamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
\def\sasSWarnContentFixed{%
   \footnotesize%
   \ttfamily%
   \color[rgb]{0,0,0}%
   \columncolor[rgb]{1,1,1}%
}
% Set cell padding
\renewcommand{\arraystretch}{1.3}

% Headings
\newcommand{\sasheading}[3][c]{{%
   \if#1r\flushright\else\if#1l\flushleft\else\centering\fi\fi%
   {\csname sasS#2\endcsname #3}\\[0.1\baselineskip]%
   \if#1r\endflushright\else\if#1l\endflushleft\else\fi\fi%
}}

\newcommand{\sasbyline}[2][c]{\sasheading[#1]{Byline}{#2}}
\newcommand{\sassystemtitle}[2][c]{\sasheading[#1]{SystemTitle}{#2}}
\newcommand{\sassystemfooter}[2][c]{\sasheading[#1]{SystemFooter}{#2}}
\newcommand{\sasproctitle}[2][c]{\sasheading[#1]{ProcTitle}{#2}}
\newcommand{\sascaption}[2][l]{\marginpar[#1]{\fbox{\parbox{0.7in}{\sasSCaption{#2}}}}}

% Declare new verbatim type
\DefineVerbatimEnvironment{sasverbatim}{BVerbatim}%
                          {fontsize=\footnotesize,
                           commandchars=\\\{\},
                           formatcom=\sasSbatch}

% Declare new column types
\newcolumntype{S}[2]{>{\csname sasS#1\endcsname}#2}
\newcolumntype{d}{r}

% Set warning box style
\newlength\notewidth
\setlength\notewidth{4in}
\newcommand*{\saswarning}[2][c]{\sasmsg{Warning}{#1}{#2}}
\newcommand*{\saserror}[2][c]{\sasmsg{Error}{#1}{#2}}
\newcommand*{\sasnote}[2][c]{\sasmsg{Note}{#1}{#2}}
\newcommand*{\sasfatal}[2][c]{\sasmsg{Fatal}{#1}{#2}}
\newcommand*{\sasmsg}[3]{%
   \ifsas@color\let\columncolor\undefined\fi%
   \begin{center}%
   \begin{tabular}{ll}\hline%
   \multicolumn{1}{|S{#1Banner}{p{0.7in}}|}{#1} & %
   \multicolumn{1}{|S{#1Content}{p{\notewidth}}|}{#3{\newline}}\\\hline%
   \end{tabular}%
   \end{center}%
   \ifsas@color\let\columncolor\sascolumncolor\fi%
}

\ifsas@color\RequirePackage{colortbl}\fi

% Hack colortbl to allow \columncolor in macros
\let\CT@extract@org\CT@extract
\def\CT@extract{\futurelet\CT@NEXT\CT@extract@next}
\def\CT@extract@next{%
  \ifx\CT@NEXT\csname
    \@ReturnAfterFi{%
      \expandafter\expandafter\expandafter
    }%
  \fi
  \CT@extract@org
}
\long\def\@ReturnAfterFi#1\fi{\fi#1}

\ifsas@color

   \newcommand{\foreground}[1]{\color[rgb]{#1}}
   \newcommand{\sascolumncolor}[2][]{}
   \let\columncolor\sascolumncolor
   \newcommand{\documentforeground}[1]{\AtBeginDocument{\color[rgb]{#1}}}
   \newcommand{\documentbackground}[1]{\AtBeginDocument{\pagecolor[rgb]{#1}}}
   \def\sastable{\let\columncolor\undefined\tabular}
   \def\endsastable{\endtabular\let\columncolor\sascolumncolor}
   \def\stackedcell{\bgroup\renewcommand{\arraystretch}{1}\tabular}
   \def\endstackedcell{\endtabular\egroup}

\else

   \newcommand{\foreground}[1]{}
   \newcommand{\color}[2][]{}
   \newcommand{\sascolumncolor}[2][]{}
   \let\columncolor\sascolumncolor
   \newcommand{\documentforeground}[1]{}
   \newcommand{\documentbackground}[1]{}
   \def\sastable{\tabular}
   \def\endsastable{\endtabular}
   \def\stackedcell{\bgroup\renewcommand{\arraystretch}{1}\tabular}
   \def\endstackedcell{\endtabular\egroup}

\fi

%\let\sasgraph\includegraphics
% Scale graphics so they always fit on the page
\newcommand\sasgraph[2][]{%
   \savebox{\sas@fig}{\includegraphics[#1]{#2}}%
   \settowidth{\sas@figwidth}{\usebox{\sas@fig}}%
   \ifthenelse{\lengthtest{\sas@figwidth > \textwidth}}{%
      \resizebox{0.95\textwidth}{!}{\usebox{\sas@fig}}}{%
      \usebox{\sas@fig}}
}

